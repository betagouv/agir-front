root /app/dist;

map $host $csp_script {
    default "script-src 'self' 'unsafe-inline'";
}

map $host $csp_style {
    default "style-src 'self' 'unsafe-inline'";
}

map $host $csp_img {
    default "img-src 'self' data: blob: res.cloudinary.com";
}

map $host $csp_font {
    default "font-src 'self' data:";
}

map $host $csp_connect {
    default "connect-src 'self' $VITE_API_URL $VITE_API_URL_CMS $VITE_MATOMO_URL";
}

map $host $csp_frame {
    default "frame-src 'self' www.youtube.com";
}

location / {
  try_files $uri $uri/ /index.html =404;
  add_header X-Frame-Options SAMEORIGIN;
  add_header X-Content-Type-Options nosniff;
  add_header X-XSS-Protection "1; mode=block";
  add_header Content-Security-Policy "${SCRIPT}; ${STYLE}; ${IMG}; ${FONT}; ${DEFAULT}; ${CONNECT}; ${FRAME}";
}